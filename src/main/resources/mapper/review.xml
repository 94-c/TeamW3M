<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="ReviewDAO">
 
  <!-- 후기 보기 -->
	<select id="getReviewList" resultMap="reviewResult">
	select * from review order by review_seq desc
	</select>
	
	<resultMap type="ReviewVO" id="reviewResult">
		<id property="review_seq " column="review_seq " />
		<result property="prod_code" column="prod_code"/>
		<result property="user_id" column="user_id"/>
		<result property="prod_url" column="prod_url"/>
		<result property="user_name" column="user_name"/>
		<result property="review_pass" column="review_pass"/>
		<result property="review_title" column="review_title"/>
		<result property="review_content" column="review_content"/>
		<result property="review_image" column="review_image"/>
		<result property="review_date" column="review_date"/>
		<result property="review_cnt" column="review_cnt"/>
	</resultMap>
 
  	<!-- 후기 작성 -->
	<insert id="insertReview" parameterType="ReviewVO">
		INSERT INTO review (prod_code, user_id, user_name, review_pass, review_seq, review_title, review_content, review_image, review_date, review_cnt)
		VALUES(#{prod_code}, #{user_id}, #{user_name}, #{review_pass}, nextval('review_seq'), #{review_title}, #{review_content}, #{review_image}, #{review_date}, #{review_cnt}) 
	</insert>
	
	<!-- 후기 상세보기 -->
	<select id="getReview" resultType="ReviewVO">
		SELECT * FROM review WHERE review_seq = #{review_seq}
	</select>
	
	<!-- 후기 수정하기 -->
	<update id="updateReview" parameterType="ReviewVO">
		UPDATE review SET review_title = #{review_title}, review_content = #{review_content} WHERE review_seq=#{review_seq}
	</update>
	
	<!-- 후기 삭제하기 -->
	<delete id="deleteReview" parameterType="ReviewVO">
		DELETE FROM review WHERE review_seq = #{review_seq}
	</delete>
	
	<select id="getProduct" resultType="com.spring.w3m.product.admin.vo.ProductVO">
		SELECT * FROM product WHERE prod_code = #{prod_code}
	</select>
	
	<select id="getUser" resultType="com.spring.w3m.join.user.vo.UserVO">
		SELECT * FROM user_member WHERE user_id = #{user_id} and user_name = #{user_name}
	</select>
</mapper>